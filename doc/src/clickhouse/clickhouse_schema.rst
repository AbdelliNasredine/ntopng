ClickHouse DB Schema
--------------------

Here the full list schema available for ClickHouse; 
Three columns are shown in the below table:
- Field: field used when doing queries on the DB
- Readable Name: Which information the column contains in a human readable format
- Type: Value data type
- Description: Description of the data

The list of protocols and alert categories can be found below the table.

+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| Field                     | Readable Name             | Type           | Description                                                                                                              |
+===========================+===========================+================+==========================================================================================================================+
| FLOW_ID                   | Flow ID                   | UInt64         | Unique Identifier of the flow, each flow has a different Flow ID                                                         |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IP_PROTOCOL_VERSION       | IP Version                | UInt8          | IP protocol version, 0 if the protocol is IPv6, 1 if it's IPv4                                                           |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| FIRST_SEEN                | First Seen                | DateTime       | The date (down to milliseconds) of the first time the flow was seen on the network                                       |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| LAST_SEEN                 | Last Seen                 | DateTime       | The date (down to milliseconds) of the last time the flow was seen on the network                                        |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| VLAN_ID                   | VLAN ID                   | UInt16         | The VLAN on which the flow was seen                                                                                      |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| PACKETS                   | Total Packets             | UInt32         | The number of Packets exchanged during the communication                                                                 |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| TOTAL_BYTES               | Total Bytes               | UInt64         | The number of Bytes exchanged during the communication                                                                   |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SRC2DST_BYTES             | Source to Dest. Bytes     | UInt64         | The number of Bytes sent from the source towards the destination during the communication                                |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| DST2SRC_BYTES             | Dest. to Source Bytes     | UInt64         | The number of Bytes sent from the destination towards the source during the communication                                |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SRC2DST_DSCP              | Source to Dest. DSCP      | UInt8          | The DSCP from the source towards the destination                                                                         |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| DST2SRC_DSCP              | Dest. to Source DSCP      | UInt8          | The DSCP from the destination towards the source                                                                         |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| PROTOCOL                  | Layer 4 Protocol          | UInt8          | The Layer 4 protocol used during the communication                                                                       |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IPV4_SRC_ADDR             | IPv4 Source Address       | UInt32         | The IPv4 address of the source                                                                                           |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IPV6_SRC_ADDR             | IPv6 Source Address       | UInt32         | The IPv6 address of the source                                                                                           |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IP_SRC_PORT               | Source Port               | UInt16         | The port used by the source                                                                                              |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IPV4_DST_ADDR             | IPv4 Destination Address  | UInt32         | The IPv4 address of the destination                                                                                      |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IPV6_DST_ADDR             | IPv6 Destination Address  | UInt32         | The IPv6 address of the destination                                                                                      |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IP_DST_PORT               | Destination Port          | UInt16         | The port used by the destination                                                                                         |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| L7_PROTO                  | Layer 7 Application Proto | UInt16         | The Application Protocol of the communication                                                                            |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| L7_PROTO_MASTER           | Layer 7 Master Proto      | UInt16         | The Master Protocol of the communication                                                                                 |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| L7_CATEGORY               | Layer 7 Category          | UInt16         | The Category of the communication                                                                                        |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| FLOW_RISK                 | Flow Risk                 | UInt64         | A bitmap containing the Flow Risk set during communication                                                               |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| INFO                      | Flow Info                 | String         | Contains extra informations regarding the communication (e.g. the URL requested)                                         |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| PROFILE                   | Profile Name              | String         | Contains the profile name                                                                                                |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| NTOPNG_INSTANCE_NAME      | Instance Name             | String         | ntopng instance name                                                                                                     |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| INTERFACE_ID              | Interface ID              | UInt16         | The Interface identifier where the flow was seen                                                                         |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| STATUS                    | Predominant Alert ID      | UInt8          | The ID of the most important alert (based on Score) the flow triggered                                                   |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SRC_COUNTRY_CODE          | Source Country Code       | UInt16         | The country code of the Source                                                                                           |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| DST_COUNTRY_CODE          | Destination Country Code  | UInt16         | The country code of the Destination                                                                                      |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SRC_LABEL                 | Source Host Name          | String         | The Host Name of the Source                                                                                              | 
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| DST_LABEL                 | Destination Host Name     | String         | The Host Name of the Destination                                                                                         |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SRC_MAC                   | Source MAC Address        | UInt64         | The MAC Address of the Source                                                                                            |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| DST_MAC                   | Destination MAC Address   | UInt64         | The MAC Address of the Destination                                                                                       |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| COMMUNITY_ID              | Community ID              | String         | The community ID of the communication                                                                                    |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SRC_ASN                   | Source AS                 | UInt32         | Autonomous system of the Source                                                                                          |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| DST_ASN                   | Destination AS            | UInt32         | Autonomous system of the Destination                                                                                     |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| PROBE_IP                  | Probe IP                  | UInt32         | IP address of the nProbe instance that sent the flow to ntopng                                                           |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| OBSERVATION_POINT_ID      | Observation Point ID      | UInt16         | The Observation Point ID where the flow was seen                                                                         |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SRC2DST_TCP_FLAGS         | Source TCP Flags          | UInt8          | A bitmap containing the TCP Flags sent from the Source to the Destination                                                |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| DST2SRC_TCP_FLAGS         | Destination TCP Flags     | UInt8          | A bitmap containing the TCP Flags sent from the Destination to the Source                                                |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SCORE                     | Score                     | UInt16         | The score indicator of the flow                                                                                          |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| CLIENT_NW_LATENCY_US      | Source Network Latency    | UInt32         | The Source Network Latency                                                                                               |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SERVER_NW_LATENCY_US      | Dest. Network Latency     | UInt32         | The Dest. Network Latency                                                                                                |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| CLIENT_LOCATION           | Source Location           | UInt8          | 0 stands for Remote Host; 1 stands for Local Host; 2 stands for Multicast Host                                           |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SERVER_LOCATION           | Destination Location      | UInt8          | 0 stands for Remote Host; 1 stands for Local Host; 2 stands for Multicast Host                                           |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SRC_NETWORK_ID            | Source Network ID         | UInt16         | The Network ID of the Source address                                                                                     |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| DST_NETWORK_ID            | Destination Network ID    | UInt16         | The Network ID of the Destination address                                                                                |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| INPUT_SNMP                | Input SNMP Interface      | UInt32         | If SNMP is enabled, contains the Input Interface ID of the device where the flow was seen                                |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| OUTPUT_SNMP               | Output SNMP Interface     | UInt32         | If SNMP is enabled, contains the Output Interface ID of the device where the flow was seen                               |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SRC_HOST_POOL_ID          | Source Host Pool ID       | UInt16         | The Host Pool ID of the Source                                                                                           |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| DST_HOST_POOL_ID          | Dest. Host Pool ID        | UInt16         | The Host Pool ID of the Destination                                                                                      |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SRC_PROC_NAME             | Source Process Name       | String         | If enabled by using nProbe Agent, contains the Source process that generate the flow                                     |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| DST_PROC_NAME             | Destination Process Name  | String         | If enabled by using nProbe Agent, contains the Destination process of the flow                                           |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SRC_PROC_USER_NAME        | Source Process Username   | String         | If enabled by using nProbe Agent, contains the Username of the Source that executed the Process                          |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| DST_PROC_USER_NAME        | Dest. Process Username    | String         | If enabled by using nProbe Agent, contains the Username of the Destination that executed the Process                     |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| ALERTS_MAP                | Alerts Bitmap             | String         | A bitmap containing all the alerts triggered by the flow                                                                 |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SEVERITY                  | Alert Severity            | String         | The severity of the communication                                                                                        |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IS_CLI_ATTACKER           | Source Attacker           | UInt8          | A Boolean representing if ntopng flagged the Source as an Attacker (1) or not (0)                                        |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IS_CLI_VICTIM             | Source Victim             | UInt8          | A Boolean representing if ntopng flagged the Source as a Victim (1) or not (0) of an attack                              |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IS_CLI_BLACKLISTED        | Blacklisted Source        | UInt8          | 1 if the Source was blacklisted, 0 otherwise                                                                             |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IS_SRV_ATTACKER           | Destination Attacker      | UInt8          | A flags representing if ntopng flagged the Destination as an Attacker (1) or not (0)                                     |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IS_SRV_VICTIM             | Destination Victim        | UInt8          | A Boolean representing if ntopng flagged the Destination as a Victim (1) or not (0) of an attack                         |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IS_SRV_BLACKLISTED        | Blacklisted Destination   | UInt8          | 1 if the Destination was blacklisted, 0 otherwise                                                                        |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| ALERT_STATUS              | Alert Acknowledged        | UInt8          | 1 if the alert was acknowledged, 0 otherwise                                                                             |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| USER_LABEL                |                           | String         |                                                                                                                          |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| USER_LABEL_TSTAMP         |                           | DateTime       |                                                                                                                          |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| ALERT_JSON                | Extra Protocol Info       | String         | A JSON field containing extra informations regarding the procotocol (e.g. In HTTP, contains the HTTP URL)                |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| IS_ALERT_DELETED          | Alert Deleted             | UInt8          | 1 if the alert was deleted, 0 otherwise                                                                                  |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| SRC2DST_PACKETS           | Source to Dest. Packets   | UInt32         | The number of packets sent from the Source towards the Destination                                                       |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| DST2SRC_PACKETS           | Dest. to Source Packets   | UInt32         | The number of packets sent from the Destination towards the Source                                                       |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+
| ALERT_CATEGORY            | Alert Category            | UInt8          | Category of the alert (e.g. Flow alert, Host alert)                                                                      |
+---------------------------+---------------------------+----------------+--------------------------------------------------------------------------------------------------------------------------+

The list of the Layer 7 protocols can be found `here <https://github.com/ntop/nDPI/blob/dev/src/include/ndpi_protocol_ids.h>`__

The list of the Layer 4 protocols can be found `here https://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml`__

The list of Alerts Category Available:

+--------+---------------------------+
| ID     | Alert Category            |
+========+===========================+
| 0      | Interface Alert           |
+--------+---------------------------+
| 1      | Host Alert                |
+--------+---------------------------+
| 2      | Network Alert             |
+--------+---------------------------+
| 3      | SNMP Alert                |
+--------+---------------------------+
| 4      | Flow Alert                |
+--------+---------------------------+
| 5      | MAC Alert                 |
+--------+---------------------------+
| 7      | User Alert                |
+--------+---------------------------+
| 8      | Active Monitoring Alert   |
+--------+---------------------------+
| 9      | System Alert              |
+--------+---------------------------+
| 15     | Other Alert               |
+--------+---------------------------+
